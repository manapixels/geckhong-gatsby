import React, { useState } from "react"
import PropTypes from "prop-types"
import { motion, AnimatePresence } from "framer-motion"
import Helmet from "react-helmet"
import { Link } from 'gatsby'
import debounce from "../helpers/debounce"
import AboutSection from "../pages/sections/about"
import "./Layout.scss"
// import 'tippy.js/dist/tippy.css'


/**
* Main layout component
*
* The Layout component wraps around each page and template.
* It also provides the header, footer as well as the main
* styles, and meta data for each page.
*
*/


const Layout = ({ children, location }) => {

	const [showScrollToTopBtn, setShowScrollToTopBtn] = useState(false)

	// let smoothScroll

	React.useEffect(() => {
		// smoothScroll = new SmoothScroll()
		window.addEventListener('scroll', handleScroll)
		return () => window.removeEventListener('scroll', handleScroll)
	}, [])

	const handleScroll = debounce(() => {
		if ((window.scrollY > window.innerHeight * 0.3) && !showScrollToTopBtn)
			setShowScrollToTopBtn(true)
		else
			setShowScrollToTopBtn(false)
	}, 250)

	return (

		<div className="container">

			<Helmet>
                <title>geckhong . Researcher, Educator, Practitioner</title>
				<link rel="icon" type="image/png" href="favicon.png" sizes="16x16" />
			</Helmet>

			<div className="layout-wrapper">

				{/* <Preloader /> */}
				<AnimatePresence>
					<motion.main
						className="main-content"
						key={location.pathname}
						variants={mainVariants}
						initial="initial"
						animate="enter"
						exit="exit"
					>
						<AboutSection />
						{/* All the main content gets inserted here, index.js, post.js */}
						{children}
					</motion.main>
				</AnimatePresence>

				<button
					className={`go-back-up ${showScrollToTopBtn ? '' : 'invisible'}`}
					onClick={() => window.scroll({
						top: 0,
						behavior: 'smooth'
					})}>
					<span className="icon-arrow-up2"></span>
				</button>

				<footer>
					<div className="d-flex align-items-center">
                        <Link to="/" className="logo d-flex" style={{ border: 'none' }}>
                            <svg
                                className="icon icon-logo"
								style={{
									width: '7rem',
    								height: '1.6rem'
								}}>
                                <use xlinkHref="#icon-logo" />
                            </svg>
                        </Link>
                        <div className="logo-subtitle d-inline-block ml-3">Researcher, Educator, Practitioner</div>
                    </div>
					<div>
						&copy; {new Date().getFullYear()} Yeo GeckHong
					</div>

					<svg className="hidden">
					<symbol id="icon-logo" viewBox="0 0 148 32">
                          <path fill="#222121" d="M13.471 7.104l0.897-0.544q0.192-0.99-0.769-0.992-1.376 0-1.375 2.112c0.011 0.686 0.092 1.347 0.236 1.984l-0.012-0.064c1.453 0.852 2.416 2.401 2.431 4.176v0.002c0.004 0.073 0.006 0.159 0.006 0.245 0 1.493-0.685 2.825-1.758 3.701l-0.009 0.007c-1.208 0.887-2.724 1.419-4.364 1.419-0.142 0-0.282-0.004-0.422-0.012l0.019 0.001c-0.919-0.004-1.815-0.097-2.681-0.271l0.088 0.015q-1.409 0.896-1.408 1.343t2.044 0.444h3.265q7.264 0 7.264 5.217c0.002 0.051 0.003 0.111 0.003 0.171 0 1.76-0.859 3.32-2.181 4.282l-0.015 0.011q-2.192 1.646-6.831 1.648-7.904 0-7.904-3.424 0-1.858 2.464-2.561l1.919 0.865c-0.156 0.526-0.249 1.13-0.255 1.756l-0 0.003q0 2.756 4.096 2.756c0.123 0.008 0.266 0.013 0.41 0.013 1.265 0 2.449-0.35 3.459-0.957l-0.030 0.017c0.797-0.476 1.326-1.326 1.345-2.302l0-0.003c0.011-0.076 0.016-0.163 0.016-0.252 0-0.655-0.327-1.235-0.826-1.583l-0.006-0.004c-0.789-0.309-1.703-0.488-2.659-0.488-0.208 0-0.414 0.008-0.617 0.025l0.027-0.002h-3.103c-0.157 0.014-0.34 0.022-0.525 0.022-1.178 0-2.278-0.329-3.215-0.901l0.027 0.015c-0.679-0.475-1.117-1.253-1.119-2.133v-0c-0.001-0.026-0.001-0.057-0.001-0.088 0-0.784 0.305-1.497 0.803-2.026l-0.001 0.002c0.832-0.787 1.764-1.481 2.773-2.058l0.071-0.037c-2.138-0.437-3.724-2.303-3.724-4.539 0-0.114 0.004-0.228 0.012-0.34l-0.001 0.015c-0.002-0.049-0.003-0.106-0.003-0.163 0-1.486 0.67-2.816 1.724-3.703l0.007-0.006q1.728-1.47 5.184-1.472c0.064-0.002 0.139-0.003 0.214-0.003 1.22 0 2.37 0.297 3.382 0.822l-0.041-0.019c-0.115-0.469-0.184-1.008-0.191-1.563l-0-0.005c-0.009-0.089-0.014-0.193-0.014-0.298 0-0.9 0.373-1.714 0.973-2.293l0.001-0.001c0.57-0.497 1.32-0.8 2.141-0.8 0.001 0 0.002 0 0.004 0h-0c0.041-0.002 0.089-0.003 0.138-0.003 0.671 0 1.288 0.236 1.77 0.63l-0.005-0.004c0.444 0.395 0.723 0.969 0.723 1.607 0 0.037-0.001 0.074-0.003 0.11l0-0.005c0.004 0.051 0.007 0.11 0.007 0.17 0 0.562-0.222 1.071-0.584 1.446l0.001-0.001c-0.353 0.328-0.828 0.528-1.349 0.528-0.015 0-0.030-0-0.044-0.001l0.002 0c-0.025 0.001-0.053 0.002-0.082 0.002-0.478 0-0.918-0.163-1.267-0.437l0.004 0.003c-0.343-0.293-0.558-0.726-0.558-1.209 0-0.006 0-0.012 0-0.018v0.001zM6.688 13.088v1.728c-0.011 0.153-0.017 0.332-0.017 0.513 0 0.858 0.141 1.683 0.401 2.453l-0.016-0.054c0.175 0.452 0.606 0.767 1.111 0.767 0.003 0 0.006 0 0.009-0h-0c0.007 0 0.016 0 0.025 0 0.488 0 0.904-0.31 1.062-0.744l0.002-0.008c0.225-0.75 0.354-1.612 0.354-2.503 0-0.205-0.007-0.409-0.020-0.611l0.001 0.027v-1.568c0.012-0.188 0.019-0.407 0.019-0.627 0-0.943-0.123-1.857-0.354-2.727l0.017 0.074c-0.142-0.458-0.561-0.784-1.057-0.784-0.005 0-0.011 0-0.016 0h0.001c-0.523 0.007-0.966 0.341-1.133 0.807l-0.003 0.008c-0.256 0.793-0.404 1.706-0.404 2.653 0 0.209 0.007 0.417 0.021 0.623l-0.002-0.028z"></path>
                          <path fill="#222121" d="M18.607 22.191c-1.29-1.435-2.078-3.343-2.078-5.435 0-0.171 0.005-0.34 0.016-0.509l-0.001 0.023c-0.009-0.139-0.015-0.302-0.015-0.465 0-2.109 0.897-4.008 2.33-5.338l0.005-0.004c1.495-1.258 3.443-2.022 5.568-2.022 0.118 0 0.236 0.002 0.352 0.007l-0.017-0.001q7.264 0 6.976 7.296h-9.024v1.244c-0.010 0.176-0.016 0.382-0.016 0.589 0 1.495 0.3 2.921 0.843 4.22l-0.027-0.072c0.473 0.96 1.444 1.608 2.566 1.608 0.077 0 0.153-0.003 0.228-0.009l-0.010 0.001q3.712 0 4.864-3.968l0.576 0.095c-0.34 1.447-1.117 2.677-2.182 3.576l-0.010 0.008c-1.177 0.814-2.635 1.301-4.207 1.301-0.192 0-0.382-0.007-0.571-0.022l0.025 0.002q-4.128 0.004-6.192-2.125zM22.751 15.104h3.296v-1.568c0.009-0.185 0.014-0.402 0.014-0.621 0-1.033-0.116-2.039-0.336-3.006l0.017 0.091c-0.121-0.544-0.599-0.945-1.171-0.945-0.016 0-0.032 0-0.047 0.001l0.002-0c-0.631 0.008-1.162 0.425-1.341 0.998l-0.003 0.010c-0.284 0.873-0.448 1.877-0.448 2.92 0 0.194 0.006 0.387 0.017 0.579l-0.001-0.026z"></path>
                          <path fill="#222121" d="M41.855 9.024c-0 0-0.001 0-0.002 0-0.957 0-1.764 0.643-2.011 1.521l-0.004 0.015c-0.399 1.291-0.629 2.776-0.629 4.314 0 0.272 0.007 0.543 0.021 0.812l-0.002-0.038v1.663c-0.014 0.202-0.021 0.437-0.021 0.675 0 1.392 0.266 2.722 0.751 3.941l-0.025-0.072c0.456 0.834 1.326 1.389 2.327 1.389 0.093 0 0.186-0.005 0.277-0.014l-0.011 0.001c0.049 0.002 0.106 0.003 0.163 0.003 1.131 0 2.147-0.494 2.842-1.279l0.003-0.004c0.708-0.794 1.215-1.782 1.433-2.874l0.007-0.039 0.576 0.065c-0.256 1.604-1.068 2.982-2.23 3.96l-0.010 0.008c-1.166 0.787-2.604 1.257-4.15 1.257-0.15 0-0.298-0.004-0.446-0.013l0.020 0.001c-0.153 0.011-0.332 0.017-0.512 0.017-2.001 0-3.824-0.767-5.189-2.022l0.005 0.005q-1.986-2-1.984-5.856c-0.010-0.146-0.015-0.316-0.015-0.487 0-2.131 0.869-4.058 2.271-5.448l0.001-0.001c1.542-1.304 3.552-2.096 5.748-2.096 0.19 0 0.379 0.006 0.566 0.018l-0.026-0.001c0.142-0.010 0.307-0.015 0.474-0.015 1.439 0 2.781 0.417 3.911 1.137l-0.029-0.018c0.908 0.6 1.5 1.614 1.504 2.767v0.001c0.008 0.090 0.013 0.194 0.013 0.3 0 0.807-0.276 1.55-0.739 2.139l0.006-0.008c-0.47 0.477-1.122 0.772-1.843 0.772-0.049 0-0.099-0.001-0.147-0.004l0.007 0c-0.043 0.002-0.094 0.004-0.146 0.004-0.719 0-1.378-0.255-1.891-0.68l0.005 0.004c-0.477-0.455-0.774-1.096-0.774-1.807 0-0.062 0.002-0.124 0.007-0.185l-0 0.008c0-0 0-0 0-0 0-0.411 0.058-0.809 0.167-1.185l-0.007 0.030h1.056c0.132-0.342 0.213-0.738 0.224-1.151l0-0.005c0.008-0.054 0.012-0.117 0.012-0.181 0-0.75-0.608-1.358-1.358-1.358-0.068 0-0.135 0.005-0.201 0.015l0.007-0.001z"></path>
                          <path fill="#222121" d="M58.494 24v-0.577h1.473l-3.616-7.423-0.608 0.159v7.264h1.471v0.577h-9.184v-0.577h1.76v-22.844h-1.888v-0.576h7.841v15.52l0.511-0.192 7.2-5.984h-3.007v-0.576h6.303v0.576h-2.236l-3.807 3.232 5.536 10.844h1.156v0.577z"></path>
                          <path fill="#222121" d="M67.87 0h7.712v11.712c0.314-0.946 0.856-1.746 1.562-2.363l0.006-0.005c0.786-0.569 1.769-0.91 2.831-0.91 0.13 0 0.258 0.005 0.385 0.015l-0.017-0.001q4.96 0 4.96 5.344v9.631h1.792v0.577h-9.056v-0.577h1.312v-10.4c0.011-0.148 0.016-0.32 0.016-0.493 0-0.707-0.1-1.391-0.285-2.039l0.013 0.052c-0.147-0.334-0.475-0.563-0.856-0.563-0.025 0-0.050 0.001-0.075 0.003l0.003-0q-1.024 0-1.808 1.344c-0.495 0.885-0.787 1.943-0.787 3.068 0 0.069 0.001 0.137 0.003 0.206l-0-0.010v8.831h1.376v0.577h-9.088v-0.577h1.76v-22.844h-1.76z"></path>
                          <path fill="#222121" d="M89.886 22.271q-2.044-2.044-2.044-5.871c-0.010-0.148-0.016-0.32-0.016-0.494 0-2.102 0.843-4.007 2.209-5.395l-0.001 0.001c1.501-1.293 3.469-2.081 5.622-2.081 0.189 0 0.377 0.006 0.564 0.018l-0.025-0.001q3.967 0 5.92 1.904t1.956 5.807q0 8.16-8.129 8.161-4.007 0-6.054-2.049zM97.918 17.696v-2.72c0.006-0.197 0.010-0.429 0.010-0.662 0-1.366-0.126-2.704-0.367-4l0.021 0.134q-0.336-1.422-1.552-1.422c-0.022-0.001-0.048-0.002-0.074-0.002-0.408 0-0.781 0.152-1.064 0.403l0.002-0.001c-0.326 0.356-0.55 0.811-0.621 1.315l-0.001 0.013c-0.187 1.137-0.294 2.448-0.294 3.783 0 0.211 0.003 0.422 0.008 0.632l-0.001-0.031v2.496c-0.013 0.292-0.021 0.634-0.021 0.978 0 1.134 0.083 2.248 0.244 3.337l-0.015-0.123c0.126 0.448 0.273 0.832 0.451 1.198l-0.019-0.042c0.225 0.463 0.691 0.776 1.23 0.776 0.051 0 0.102-0.003 0.152-0.008l-0.006 0.001c0.002 0 0.005 0 0.008 0 0.834 0 1.523-0.625 1.623-1.432l0.001-0.008c0.194-1.102 0.306-2.372 0.306-3.667 0-0.333-0.007-0.664-0.022-0.993l0.002 0.047z"></path>
                          <path fill="#222121" d="M105.022 8.768h7.712v2.944c0.315-0.946 0.856-1.746 1.562-2.363l0.006-0.005c0.786-0.569 1.768-0.91 2.831-0.91 0.13 0 0.258 0.005 0.386 0.015l-0.017-0.001q4.96 0 4.96 5.344v9.631h1.792v0.577h-9.056v-0.577h1.316v-10.4c0.011-0.148 0.016-0.32 0.016-0.493 0-0.707-0.1-1.391-0.285-2.039l0.013 0.052c-0.147-0.334-0.475-0.563-0.856-0.563-0.025 0-0.050 0.001-0.075 0.003l0.003-0q-1.024 0-1.807 1.344c-0.496 0.885-0.788 1.942-0.788 3.068 0 0.069 0.001 0.138 0.003 0.206l-0-0.010v8.831h1.376v0.577h-9.092v-0.577h1.761v-14.078h-1.761z"></path>
                          <path fill="#222121" d="M137.502 7.104l0.896-0.544q0.192-0.99-0.768-0.992-1.377 0-1.376 2.112c0.011 0.686 0.092 1.347 0.236 1.985l-0.012-0.065c1.453 0.852 2.417 2.401 2.432 4.176v0.002c0.004 0.073 0.006 0.159 0.006 0.245 0 1.493-0.685 2.825-1.758 3.701l-0.009 0.007c-1.208 0.887-2.725 1.419-4.366 1.419-0.142 0-0.282-0.004-0.422-0.012l0.019 0.001c-0.919-0.004-1.815-0.097-2.681-0.271l0.089 0.015q-1.408 0.896-1.408 1.343t2.044 0.444h3.264q7.264 0 7.264 5.217c0.002 0.051 0.003 0.112 0.003 0.172 0 1.76-0.859 3.319-2.18 4.281l-0.015 0.011q-2.194 1.646-6.832 1.648-7.904 0-7.904-3.424 0-1.858 2.464-2.561l1.919 0.865c-0.156 0.526-0.249 1.13-0.255 1.756l-0 0.003q0 2.756 4.096 2.756c0.123 0.008 0.266 0.012 0.41 0.012 1.266 0 2.45-0.35 3.46-0.957l-0.030 0.017c0.796-0.476 1.325-1.327 1.344-2.302l0-0.003c0.011-0.076 0.016-0.163 0.016-0.252 0-0.655-0.327-1.235-0.826-1.583l-0.006-0.004c-0.789-0.309-1.702-0.488-2.657-0.488-0.208 0-0.414 0.009-0.617 0.025l0.027-0.002h-3.104c-0.157 0.014-0.34 0.022-0.525 0.022-1.177 0-2.278-0.329-3.214-0.901l0.027 0.015c-0.679-0.475-1.118-1.253-1.12-2.133v-0c-0.001-0.026-0.001-0.056-0.001-0.086 0-0.784 0.305-1.498 0.803-2.027l-0.001 0.002c0.832-0.787 1.765-1.481 2.773-2.058l0.071-0.038c-2.138-0.437-3.723-2.303-3.723-4.538 0-0.115 0.004-0.228 0.012-0.341l-0.001 0.015c-0.002-0.049-0.003-0.106-0.003-0.163 0-1.486 0.67-2.815 1.723-3.703l0.007-0.006q1.728-1.47 5.184-1.472c0.064-0.002 0.139-0.003 0.214-0.003 1.22 0 2.37 0.297 3.382 0.822l-0.041-0.019c-0.115-0.468-0.184-1.008-0.192-1.563l-0-0.005c-0.009-0.089-0.014-0.192-0.014-0.297 0-0.901 0.373-1.714 0.973-2.294l0.001-0.001c0.57-0.497 1.32-0.8 2.141-0.8 0.001 0 0.002 0 0.003 0h-0c0.041-0.002 0.089-0.003 0.138-0.003 0.672 0 1.288 0.236 1.771 0.63l-0.005-0.004c0.444 0.395 0.723 0.969 0.723 1.607 0 0.037-0.001 0.074-0.003 0.11l0-0.005c0.004 0.051 0.007 0.11 0.007 0.169 0 0.562-0.222 1.072-0.583 1.447l0.001-0.001c-0.353 0.328-0.828 0.528-1.35 0.528-0.015 0-0.030-0-0.044-0l0.002 0c-0.025 0.001-0.054 0.002-0.083 0.002-0.478 0-0.917-0.163-1.266-0.437l0.004 0.003c-0.342-0.293-0.557-0.726-0.557-1.208 0-0.007 0-0.013 0-0.020v0.001zM130.718 13.088v1.728c-0.011 0.153-0.017 0.331-0.017 0.511 0 0.859 0.141 1.685 0.401 2.456l-0.016-0.054c0.175 0.452 0.607 0.767 1.112 0.767 0.003 0 0.006 0 0.009-0h-0c0.007 0 0.016 0 0.024 0 0.488 0 0.904-0.31 1.061-0.744l0.002-0.008c0.225-0.75 0.355-1.613 0.355-2.505 0-0.205-0.007-0.408-0.020-0.609l0.001 0.027v-1.568c0.012-0.188 0.019-0.407 0.019-0.628 0-0.943-0.124-1.856-0.355-2.726l0.017 0.074c-0.141-0.457-0.561-0.784-1.056-0.784-0.006 0-0.011 0-0.017 0h0.001c-0.523 0.007-0.966 0.341-1.133 0.807l-0.003 0.008c-0.256 0.793-0.404 1.706-0.404 2.653 0 0.209 0.007 0.417 0.021 0.623l-0.002-0.028z"></path>
                          <path fill="#265fff" d="M145.262 24.32c-0.058 0.005-0.126 0.007-0.195 0.007-0.744 0-1.414-0.316-1.884-0.822l-0.001-0.002c-0.429-0.512-0.69-1.178-0.69-1.904 0-0.028 0-0.056 0.001-0.085l-0 0.004c-0.001-0.023-0.001-0.050-0.001-0.078 0-0.727 0.274-1.39 0.724-1.892l-0.002 0.003c0.473-0.496 1.139-0.805 1.877-0.805 0.054 0 0.108 0.002 0.162 0.005l-0.007-0c0.049-0.003 0.107-0.004 0.165-0.004 0.728 0 1.397 0.255 1.921 0.681l-0.006-0.004c0.478 0.463 0.774 1.11 0.774 1.827 0 0.067-0.003 0.133-0.008 0.199l0.001-0.009c0.003 0.051 0.005 0.11 0.005 0.169 0 0.745-0.274 1.425-0.727 1.946l0.003-0.004c-0.495 0.479-1.171 0.774-1.915 0.774-0.069 0-0.138-0.003-0.206-0.008l0.009 0.001z"></path>
                      </symbol>
					</svg>
				</footer>

			</div>
		</div>
	)
}

const duration = 0.4

const mainVariants = {
	initial: {
		y: 20,
		opacity: 0,
	},
	enter: {
		y: 0,
		opacity: 1,
		transition: {
			duration: duration,
			delay: duration,
			when: 'beforeChildren',
		},
	},
	exit: {
		y: -20,
		opacity: 0,
		transition: { duration: duration },
	},
}

Layout.propTypes = {
	children: PropTypes.node.isRequired,
	bodyClass: PropTypes.string,
}

export default Layout